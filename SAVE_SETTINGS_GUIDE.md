# 📋 保存先設定ガイド

## 🎯 保存先の仕組み

### **3つの保存先**
1. **Google Slides** - 生成されたスライド
2. **マスタースプレッドシート** - チーム共有データベース
3. **個人スプレッドシート** - 個人用バックアップ

## 📊 スプレッドシートの設定

### **ステップ1: スプレッドシートの作成**

#### **A. マスタースプレッドシート（チーム用）**
```
1. Google Driveを開く
2. 新規 → Google スプレッドシート
3. 名前を「ロケハンマスターDB」に変更
4. URLからIDを取得：
   https://docs.google.com/spreadsheets/d/[ここがID]/edit
   例: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
```

#### **B. 個人スプレッドシート（オプション）**
```
1. Google Driveで新規スプレッドシート作成
2. 名前を「ロケハン個人DB_[名前]」に変更
3. 同様にIDを取得
```

### **ステップ2: スプレッドシートの共有設定**

#### **マスタースプレッドシート**
```
1. 右上の「共有」ボタンをクリック
2. チームメンバーのメールアドレスを追加
3. 権限: 「編集者」を選択
4. 「送信」をクリック
```

#### **共有レベルの選択**
- **編集者**: データの追加・編集可能（推奨）
- **閲覧者**: 閲覧のみ
- **コメント可**: コメント追加可能

### **ステップ3: 拡張機能での設定**

#### **設定画面での入力**
```
【チーム共有設定】
☑️ チーム共有モードを有効にする
マスターDB ID: [1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms]

【個人設定】  
個人用スプレッドシートID: [2CyiNWt1YSB6oGNgLwCeCajhnVVrqulct85PhwF3vqnt]
```

## 📑 Google Slidesの設定

### **ステップ1: 共有フォルダの作成（チーム用）**

```
1. Google Driveを開く
2. 新規 → フォルダ
3. 名前を「ロケハンスライド共有」に変更
4. URLからフォルダIDを取得：
   https://drive.google.com/drive/folders/[ここがID]
   例: 1aB2cD3eF4gH5iJ6kL7mN8oP9qR0sT1uV
```

### **ステップ2: フォルダの共有設定**

```
1. フォルダを右クリック → 共有
2. チームメンバーのメールアドレスを追加
3. 権限: 「編集者」を選択
4. 「送信」をクリック
```

### **ステップ3: 拡張機能での設定**

```
【チーム共有設定】
共有フォルダID: [1aB2cD3eF4gH5iJ6kL7mN8oP9qR0sT1uV]
```

## 🔍 ID/URLの確認方法

### **スプレッドシートID**
```
URL例:
https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit#gid=0

抽出するID:
1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
```

### **フォルダID**
```
URL例:
https://drive.google.com/drive/folders/1aB2cD3eF4gH5iJ6kL7mN8oP9qR0sT1uV

抽出するID:
1aB2cD3eF4gH5iJ6kL7mN8oP9qR0sT1uV
```

## 📁 保存時の動作

### **個人モード（チーム共有OFF）**
```
生成されたスライド → 個人のGoogle Drive
データ → 個人スプレッドシート（設定時）
```

### **チームモード（チーム共有ON）**
```
生成されたスライド → 共有フォルダ
データ → マスタースプレッドシート
バックアップ → 個人スプレッドシート（オプション）
```

## ⚙️ 自動作成機能

### **スプレッドシートIDが空欄の場合**
```
1. 自動で新規スプレッドシート作成
2. 「ロケハンDB」という名前で作成
3. ヘッダー行を自動設定
4. 作成されたIDを自動保存
```

### **フォルダIDが空欄の場合**
```
1. 個人のDriveルートに保存
2. 「マイドライブ」直下に配置
```

## 🔧 トラブルシューティング

### **問題: 「権限がありません」エラー**

#### **原因と解決法**
```
原因: スプレッドシート/フォルダの共有設定が不適切

解決法:
1. 対象のスプレッドシート/フォルダを開く
2. 共有設定を確認
3. 自分のアカウントに「編集者」権限があるか確認
4. なければ管理者に権限付与を依頼
```

### **問題: 「IDが無効です」エラー**

#### **原因と解決法**
```
原因: IDのコピーミス

解決法:
1. URLから正確にIDをコピー
2. 前後の余分な文字（/や#）を含めない
3. IDは英数字のみ（約44文字）
```

### **問題: 「保存されない」**

#### **原因と解決法**
```
原因1: ネットワークエラー
解決法: インターネット接続を確認

原因2: Google認証切れ
解決法: 拡張機能を再読み込み、再認証

原因3: API制限
解決法: 時間を置いて再試行
```

## 📝 設定例

### **個人利用の場合**
```
登録者名: 山田太郎
☐ チーム共有モード（OFF）
個人用スプレッドシートID: [自動作成または手動入力]
```

### **チーム利用の場合**
```
登録者名: 山田太郎
☑️ チーム共有モード（ON）
共有フォルダID: 1aB2cD3eF4gH5iJ6kL7mN8oP9qR0sT1uV
マスターDB ID: 1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms
個人用スプレッドシートID: [オプション]
```

## 🎯 推奨設定

### **小規模チーム（2-5人）**
- マスタースプレッドシート1つで管理
- 個人バックアップは任意

### **大規模チーム（6人以上）**
- マスタースプレッドシート必須
- 個人バックアップ推奨
- フォルダを月別に分ける

### **個人利用**
- チーム共有OFF
- 個人スプレッドシートのみ

## 📊 データ構造

### **マスタースプレッドシート（9列）**
| A | B | C | D | E | F | G | H | I |
|---|---|---|---|---|---|---|---|---|
| 登録者 | 登録日時 | URL | 場所名 | 住所 | 電車アクセス | 車アクセス | 駐車場 | スライドURL |

### **個人スプレッドシート（8列）**
| A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|
| 登録日時 | URL | 場所名 | 住所 | 電車アクセス | 車アクセス | 駐車場 | スライドURL |

## ✅ チェックリスト

### **初期設定時**
- [ ] Google アカウントでログイン
- [ ] 拡張機能の認証完了
- [ ] OpenAI APIキー設定
- [ ] 登録者名入力
- [ ] スプレッドシート作成/ID取得
- [ ] （チーム用）共有設定完了
- [ ] （チーム用）フォルダID取得
- [ ] 設定を保存

### **使用前確認**
- [ ] インターネット接続
- [ ] Google認証有効
- [ ] APIキー有効
- [ ] 保存先の権限確認