# スライドテンプレート設定ガイド

## 🎨 カスタムスライドフォーマットの指定方法

### 方法1: テンプレートURLを使用（推奨）

#### ステップ1: マスタースライドを作成
1. Google Slidesで理想的なレイアウトのプレゼンテーションを作成
2. 各スライドに以下のプレースホルダーテキストを配置：
   - `{{場所名}}` - 場所の名前
   - `{{住所}}` - 住所情報
   - `{{電車アクセス}}` - 電車でのアクセス
   - `{{車アクセス}}` - 車でのアクセス
   - `{{駐車場情報}}` - 駐車場の有無と料金
   - `{{URL}}` - 参照元URL
   - `{{日付}}` - 作成日

#### ステップ2: テンプレートとして保存
1. ファイル → コピーを作成
2. 名前を「ロケハンテンプレート_マスター」に設定
3. 共有設定を「リンクを知っている全員が閲覧可能」に

#### ステップ3: 拡張機能に設定
1. 拡張機能の設定画面を開く
2. 「テンプレート設定」タブ
3. テンプレートURLを貼り付け
4. 保存

### 方法2: JSONで詳細設定

#### template-config.json
```json
{
  "templateId": "YOUR_TEMPLATE_SLIDE_ID",
  "slideFormat": {
    "totalSlides": 5,
    "slides": [
      {
        "slideNumber": 1,
        "title": "{{場所名}}",
        "subtitle": "ロケハン調査資料",
        "layout": "TITLE"
      },
      {
        "slideNumber": 2,
        "title": "基本情報",
        "content": {
          "住所": "{{住所}}",
          "URL": "{{URL}}"
        },
        "layout": "TITLE_AND_BODY"
      },
      {
        "slideNumber": 3,
        "title": "アクセス情報",
        "content": {
          "電車": "{{電車アクセス}}",
          "車": "{{車アクセス}}"
        },
        "layout": "TITLE_AND_TWO_COLUMNS"
      },
      {
        "slideNumber": 4,
        "title": "駐車場情報",
        "content": "{{駐車場情報}}",
        "layout": "TITLE_AND_BODY"
      },
      {
        "slideNumber": 5,
        "title": "メモ・備考",
        "content": "",
        "layout": "TITLE_AND_BODY"
      }
    ]
  }
}
```

### 方法3: 拡張機能UI内でカスタマイズ

設定画面の「スライドエディタ」で直接編集：
1. 各スライドのレイアウトを選択
2. 表示する情報フィールドをドラッグ&ドロップ
3. フォント・カラーを設定
4. プレビューで確認
5. テンプレートとして保存

## 📊 スプレッドシート連携設定

### 保存先スプレッドシートの設定

#### ステップ1: スプレッドシートを準備
1. Google Sheetsで新規スプレッドシートを作成
2. シート名を「ロケハンDB」に設定
3. 以下のヘッダーを1行目に追加：

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| 登録日時 | URL | 場所名 | 住所 | 電車アクセス | 車アクセス | 駐車場 | スライドURL |

#### ステップ2: スプレッドシートIDを取得
1. スプレッドシートのURLから抽出：
   ```
   https://docs.google.com/spreadsheets/d/[この部分がID]/edit
   ```
2. IDをコピー

#### ステップ3: 拡張機能に設定
1. 設定画面 → データ保存設定
2. スプレッドシートIDを入力
3. 自動保存をON

### データフォーマット詳細

#### 保存される情報
```javascript
{
  "timestamp": "2024-01-20 14:30:00",
  "url": "https://example.com/location",
  "locationName": "東京スカイツリー",
  "address": "〒131-0045 東京都墨田区押上1-1-2",
  "trainAccess": "東武スカイツリーライン「とうきょうスカイツリー」駅すぐ、東京メトロ半蔵門線「押上」駅直結",
  "carAccess": "首都高速6号向島線「向島」出口より約10分",
  "parking": "有り - 30分350円（最初の1時間無料）",
  "slideUrl": "https://docs.google.com/presentation/d/xxxxx/edit"
}
```

## 🔧 高度な設定

### GPTプロンプトのカスタマイズ

特定の情報を重点的に抽出したい場合：

```javascript
// custom-prompts.js
export const locationPrompts = {
  parking: `
    以下の情報を特に詳しく抽出してください：
    - 駐車場の有無
    - 駐車可能台数
    - 料金体系（時間料金、1日料金、無料時間など）
    - 近隣のコインパーキング情報
    - 大型車両の駐車可否
  `,
  
  access: `
    アクセス情報を詳細に抽出：
    - 最寄り駅からの所要時間（徒歩）
    - 複数路線がある場合は全て記載
    - バス利用の場合の路線番号と停留所名
    - 高速道路のIC名と所要時間
    - タクシー利用時の目安料金
  `
}
```

### フィールドマッピング設定

Webページの構造に応じた抽出ルール：

```json
{
  "fieldMapping": {
    "駐車場": [
      "selector: .parking-info",
      "keyword: 駐車場, パーキング, P",
      "pattern: /[0-9]+台/",
      "pattern: /[0-9]+分[0-9]+円/"
    ],
    "電車アクセス": [
      "selector: .access-train",
      "keyword: 駅, 電車, 地下鉄, JR",
      "pattern: /.*駅.*(徒歩|直結|すぐ)/"
    ]
  }
}
```

## 📝 テンプレート例

### 観光施設向けテンプレート
- スライド1: タイトル（施設名・写真）
- スライド2: 基本情報（住所・営業時間・料金）
- スライド3: アクセス（電車・車・バス）
- スライド4: 駐車場詳細（料金表・地図）
- スライド5: 撮影ポイント・注意事項

### 飲食店向けテンプレート
- スライド1: 店舗名・外観
- スライド2: 基本情報（住所・営業時間・定休日）
- スライド3: アクセス・駐車場
- スライド4: 店内レイアウト・席数
- スライド5: メニュー・価格帯

### イベント会場向けテンプレート
- スライド1: 会場名
- スライド2: 所在地・収容人数
- スライド3: 交通アクセス
- スライド4: 駐車場・搬入経路
- スライド5: 設備・レンタル機材

## 🚀 ワークフロー最適化

### バッチ処理設定
複数のURLを一括処理：

```javascript
// batch-config.json
{
  "batchMode": true,
  "urls": [
    "https://location1.com",
    "https://location2.com",
    "https://location3.com"
  ],
  "outputFormat": {
    "slides": true,
    "spreadsheet": true,
    "pdf": false
  },
  "scheduling": {
    "delay": 5000,  // 各処理間の待機時間（ミリ秒）
    "retryOnError": true,
    "maxRetries": 3
  }
}
```

## ❓ よくある質問

### Q: 既存のスライドテンプレートを使いたい
A: Google Slidesでテンプレートを作成し、スライドIDを設定画面に入力してください。

### Q: 特定のフィールドが抽出されない
A: カスタムプロンプトで該当フィールドの抽出ルールを追加してください。

### Q: スプレッドシートの列を追加したい
A: 設定ファイルのfieldMappingに新しいフィールドを追加し、対応する抽出ルールを定義してください。

### Q: 画像も一緒に保存したい
A: 設定で「画像URLを含める」をONにすると、スプレッドシートに画像URLが保存されます。